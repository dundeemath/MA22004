<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Module documents and lecture notes for MA22004 - Statistics II, a second year module about inferential statistics at the University of Dundee.">

<title>MA22004 — Statistics II - 6&nbsp; Linear regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./07-categorical-data.html" rel="next">
<link href="./05-anova.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./00-prelim.html">Lecture Notes</a></li><li class="breadcrumb-item"><a href="./06-linear-models.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Linear regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MA22004 — Statistics II</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/dundeemath/MA22004/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./MA22004-—-Statistics-II.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Module Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about-me.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About Your Instructor</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./labs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./writing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Writing Lab Reports</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Lecture Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-prelim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preliminaries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-sampling-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sampling distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-basics-stat-infer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basics of statistical inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-infer-single-sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Single sample inferences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-infer-two-samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Two samples inferences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Analysis of variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-linear-models.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-categorical-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Categorical data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-quality-control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Quality control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-investigations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Curated Content</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-simple-linear-regression" id="toc-sec-simple-linear-regression" class="nav-link active" data-scroll-target="#sec-simple-linear-regression"><span class="header-section-number">6.1</span> Simple linear regression models</a></li>
  <li><a href="#sec-ls-estimate-var" id="toc-sec-ls-estimate-var" class="nav-link" data-scroll-target="#sec-ls-estimate-var"><span class="header-section-number">6.2</span> Estimating <span class="math inline">\sigma^2</span> for linear regressions</a></li>
  <li><a href="#sec-inference-ls" id="toc-sec-inference-ls" class="nav-link" data-scroll-target="#sec-inference-ls"><span class="header-section-number">6.3</span> Inferences for least-squares parameters</a></li>
  <li><a href="#sec-correlation" id="toc-sec-correlation" class="nav-link" data-scroll-target="#sec-correlation"><span class="header-section-number">6.4</span> Correlation</a></li>
  <li><a href="#prediction-using-linear-models" id="toc-prediction-using-linear-models" class="nav-link" data-scroll-target="#prediction-using-linear-models"><span class="header-section-number">6.5</span> Prediction using linear models</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/dundeemath/MA22004/edit/master/06-linear-models.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/dundeemath/MA22004/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./00-prelim.html">Lecture Notes</a></li><li class="breadcrumb-item"><a href="./06-linear-models.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Linear regression</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-linear-models" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Linear regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Regression analysis allows us to study the relationship among two or more rvs. Typically, we are interested in the relationship between a response or dependent rv <span class="math inline">Y</span> and a covariate <span class="math inline">X.</span> The relationship between <span class="math inline">X</span> and <span class="math inline">Y</span> will be explained through a regression function, <span class="math display">
r(x) = \mathop{\mathrm{\mathbf{E}}}[Y \mid X = x] = \int y f(y\mid x) dy \,.
</span> In particular, we shall assume that <span class="math inline">r</span> is linear, <span id="eq-linear-regression-function"><span class="math display">
r(x) = \beta_0 + \beta_1 x\,,
\tag{6.1}</span></span> and estimate the intercept <span class="math inline">\beta_0</span> and slope <span class="math inline">\beta_1</span> of this linear model from sample data <span class="math display">
(Y_1, X_1), \dots, (Y_m, X_m) \sim F_{Y,X}\,.
</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alternative lingo
</div>
</div>
<div class="callout-body-container callout-body">
<p>The covariates <span class="math inline">X</span> are also called predictor variables, explanatory variables, independent variables, and/or features depending on who you are talking to.</p>
</div>
</div>
<section id="sec-simple-linear-regression" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sec-simple-linear-regression"><span class="header-section-number">6.1</span> Simple linear regression models</h2>
<p>The simplest regression is when <span class="math inline">X_i</span> is one-dimensional and <span class="math inline">r(x)</span> is linear as in <a href="#eq-linear-regression-function" class="quarto-xref">Equation&nbsp;<span>6.1</span></a>. A linear regression posits the expected value of <span class="math inline">Y_i</span> is a linear function of the data <span class="math inline">X_i,</span> but that <span class="math inline">Y</span> deviates from its expected value by a random amount for fixed <span class="math inline">x_i.</span></p>
<div id="def-linear-model" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6.1</strong></span> The simple linear regression model relates a random response <span class="math inline">Y_i</span> to a set of independent variables <span class="math inline">X_i,</span> <span id="eq-linear-model"><span class="math display">
Y_i = \beta_0 + \beta_1 X_i + \epsilon_i \,,
\tag{6.2}</span></span> where the intercept <span class="math inline">\beta_0</span> and slope <span class="math inline">\beta_1</span> are unknown parameters and the random deviation or random error <span class="math inline">\epsilon_i</span> is a rv assumed to satisfy:</p>
<ol type="1">
<li><span class="math inline">\mathop{\mathrm{\mathbf{E}}}[\epsilon_i \mid X_i = x_i] = 0,</span></li>
<li><span class="math inline">\mathop{\mathrm{Var}}[\epsilon_i \mid X_i = x_i] = \sigma^2</span> does not depend on <span class="math inline">x_i,</span></li>
<li><span class="math inline">\epsilon_i</span> and <span class="math inline">\epsilon_j</span> are independent for <span class="math inline">i, j = 1, \dots, m.</span></li>
</ol>
</div>
<p>From the assumptions on <span class="math inline">\epsilon_i,</span> the linear model <a href="#eq-linear-model" class="quarto-xref">Equation&nbsp;<span>6.2</span></a> implies <span class="math display">
\mathop{\mathrm{\mathbf{E}}}[Y_i \mid X_i = x_i] = \beta_0 + \beta_1 x_i \,.
</span> Thus, if <span class="math inline">\widehat{\beta}_0</span> and <span class="math inline">\widehat{\beta}_1</span> are estimators of <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1,</span> then the fitted line is <span class="math display">
\widehat{r}(x) = \widehat{\beta}_0 + \widehat{\beta}_1 x
</span> and the predicted or fitted value <span class="math inline">\widehat{Y}_i = \widehat{r}(X_i)</span> is an estimator for <span class="math inline">\mathop{\mathrm{\mathbf{E}}}[Y_i \mid X_i = x_i].</span> The residuals are defined to be <span id="eq-ls-residuals"><span class="math display">
\widehat{\epsilon}_i = Y_i - \widehat{Y}_i = Y_i - \left( \widehat{\beta}_0 + \widehat{\beta}_1 X_i \right) \,.
\tag{6.3}</span></span> The residual sums of squares, <span id="eq-rss"><span class="math display">
\mathsf{RSS} = \sum_{i=1}^m \widehat{\epsilon}_i^2\,,
\tag{6.4}</span></span> measures how well the regression line <span class="math inline">\widehat{r}</span> fits the data <span class="math inline">(Y_1, X_1), \dots, (Y_m, X_m).</span> The least squares estimates of <span class="math inline">\widehat{\beta}_0</span> and <span class="math inline">\widehat{\beta}_1</span> are the values that minimize the <span class="math inline">\mathsf{RSS}</span> in <a href="#eq-rss" class="quarto-xref">Equation&nbsp;<span>6.4</span></a>.</p>
<div id="thm-least-squares-estimates" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.1</strong></span> The least squares estimates for <span class="math inline">\widehat{\beta}_1</span> and <span class="math inline">\widehat{\beta}_0</span> are given by, respectively, <span id="eq-ls-slope"><span class="math display">
\widehat{\beta}_1 = \frac{\sum_{i=1}^m (X_i - \overline{X})(Y_i - \overline{Y})}{\sum_{i=1}^m (X_i - \overline{X})^2} = \frac{S_{xy}}{S_{xx}} \,,
\tag{6.5}</span></span> and <span id="eq-ls-intercept"><span class="math display">
\widehat{\beta}_0 = \overline{Y} - \widehat{\beta}_1 \overline{X}\,.
\tag{6.6}</span></span></p>
</div>
<p><a href="#eq-rss" class="quarto-xref">Equation&nbsp;<span>6.4</span></a> is a function of <span class="math inline">\widehat{\beta}_0</span> and <span class="math inline">\widehat{\beta}_1</span> from the definition of the residuals <a href="#eq-ls-residuals" class="quarto-xref">Equation&nbsp;<span>6.3</span></a>. Then <a href="#eq-ls-slope" class="quarto-xref">Equation&nbsp;<span>6.5</span></a> and <a href="#eq-ls-intercept" class="quarto-xref">Equation&nbsp;<span>6.6</span></a> follow by equating the partial derivatives of <a href="#eq-rss" class="quarto-xref">Equation&nbsp;<span>6.4</span></a> to zero. The <span class="math inline">\widehat{\beta}_0</span> and <span class="math inline">\widehat{\beta}_1</span> are the unique solution to this linear system.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alternative lingo
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <span class="math inline">\mathsf{RSS}</span> is sometimes referred to as the error sum of squares and abbreviated <span class="math inline">\mathsf{SSE}</span> (no, the order is not a typo).</p>
</div>
</div>
<div id="exm-linear-model-fit-residuals" class="theorem example">
<p><span class="theorem-title"><strong>Example 6.1</strong></span> In <a href="#fig-linear-model-fit" class="quarto-xref">Figure&nbsp;<span>6.1</span></a> and <a href="#fig-linear-model-residuals" class="quarto-xref">Figure&nbsp;<span>6.2</span></a>, we consider the <strong>Cherry Tree Data</strong> (see <a href="02-basics-stat-infer.html#tbl-cherry-data" class="quarto-xref">Table&nbsp;<span>2.1</span></a>) and discussion). We fit a least squares regression of timber volume (response variable) to the tree’s diameter (independent variable). As you would expect, the timber yield increases with diameter.</p>
<p>The <code>r</code> code below can be used to calculate the least squares regression and residuals.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(trees)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> trees<span class="sc">$</span>Volume</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> trees<span class="sc">$</span>Girth <span class="co"># NB: this is the diameter; data mislabeled!</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">resid</span>(fit)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>fit</code> data frame contains the estimates for <span class="math inline">\widehat{\beta}_0</span> and <span class="math inline">\widehat{\beta}_1</span>:</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           x 
 -36.943459    5.065856 </code></pre>
</div>
</div>
<p>Both <a href="#fig-linear-model-fit" class="quarto-xref">Figure&nbsp;<span>6.1</span></a> and <a href="#fig-linear-model-residuals" class="quarto-xref">Figure&nbsp;<span>6.2</span></a> are scatter plots of the observed values <span class="math inline">y.</span> In <a href="#fig-linear-model-fit" class="quarto-xref">Figure&nbsp;<span>6.1</span></a>, the regression line <span class="math inline">\widehat{y}</span> is plotted along with the residuals <span class="math inline">\widehat{\epsilon}.</span> In <a href="#fig-linear-model-residuals" class="quarto-xref">Figure&nbsp;<span>6.2</span></a>, the sample mean <span class="math inline">\overline{y}</span> is plotted together with the deviations <span class="math inline">y - \overline{y}.</span></p>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-linear-model-fit" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linear-model-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-linear-models_files/figure-html/fig-linear-model-fit-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linear-model-fit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: Linear regression (or least squares fit) of Volume to Diameter from the <strong>Cherry Tree Data</strong>. The vertical bars between the observed data point and the regression line indicate the error in the fit (the least squares residual). The residuals are squared and summed to yield the <span class="math inline">\mathsf{RSS}</span> (alt: <span class="math inline">\mathsf{SSE}</span>).
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-linear-model-residuals" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linear-model-residuals-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-linear-models_files/figure-html/fig-linear-model-residuals-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linear-model-residuals-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: The deviations about the sample mean <span class="math inline">\overline{y}.</span> The sum of the squared deviations or <span class="math inline">\mathsf{SST}</span> (total sum of squares) is a measure of the total variation in the observations.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-ls-estimate-var" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="sec-ls-estimate-var"><span class="header-section-number">6.2</span> Estimating <span class="math inline">\sigma^2</span> for linear regressions</h2>
<p>The parameter <span class="math inline">\sigma^2</span> (the variance of the random deviation) determines the variability in the regression model.</p>
<div id="thm-least-squares-var-estimate" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6.2</strong></span> An unbiased estimate of <span class="math inline">\sigma^2</span> is given by <span id="eq-least-squares-var-estimate"><span class="math display">
\widehat{\sigma}^2 = s^2 = \frac{\mathsf{RSS}}{m-2} = \frac{1}{m-2} \sum_{i=1}^m (y_i - \widehat{y}_i)^2\,.
\tag{6.7}</span></span></p>
</div>
<p>In <a href="#fig-linear-model-sigma-large-v-small" class="quarto-xref">Figure&nbsp;<span>6.3</span></a>, we present a least squares regression of timber volume on both tree diameter and height (for the <strong>Cherry Tree Data</strong>). As expected, the regressions indicate the volume increases with both covariates. Estimates for the variance of the random deviation <a href="#eq-least-squares-var-estimate" class="quarto-xref">Equation&nbsp;<span>6.7</span></a> in both regression models, <span class="math inline">\sigma_{D}^2</span> and <span class="math inline">\sigma_{H}^2,</span> respectively, are computed to be <span class="math inline">s^2_{D} = 18.08</span> and <span class="math inline">s^2_{H} = 179.48.</span> Thus, we see that small variances lead to observations of <span class="math inline">(x_i, y_i)</span> that sit tightly around the regression line, in contrast to large variances that lead to a large cloud of points.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-linear-model-sigma-large-v-small" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linear-model-sigma-large-v-small-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-linear-models_files/figure-html/fig-linear-model-sigma-large-v-small-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linear-model-sigma-large-v-small-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: For the <strong>Cherry Tree Data</strong>, we estimate the variance to be <span class="math inline">s^2_{D} = 18.08</span> (for Diameter) and <span class="math inline">s^2_{H} = 179.48</span> (for Height); small variances lead to observations of <span class="math inline">(x_i, y_i)</span> that sit tightly around the regression line, in contrast to large variances that lead to a large cloud of points.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why do we lose two degrees of freedom?
</div>
</div>
<div class="callout-body-container callout-body">
<p>In <a href="#thm-least-squares-var-estimate" class="quarto-xref">Theorem&nbsp;<span>6.2</span></a>, the number in the denominator is the df associated with the <span class="math inline">\mathsf{RSS}</span> and <span class="math inline">s^2.</span> To calculate <span class="math inline">\mathsf{RSS},</span> you must estimate two parameters <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1,</span> which results in the loss of two df. Hence the <span class="math inline">m-2.</span></p>
</div>
</div>
<p>We note to make inferences, the statistic <span class="math display">
S^2 = \frac{\mathsf{RSS}}{m-2}
</span> is an unbiased estimator or <span class="math inline">\sigma^2</span> and the random variable <span class="math display">
\frac{(m-2) S^2}{\sigma^2} \sim \chi^2(m-2)\,.
</span> Moreover, the statistic <span class="math inline">S^2</span> is independent of both <span class="math inline">\widehat{\beta}_0</span> and <span class="math inline">\widehat{\beta}_1.</span></p>
</section>
<section id="sec-inference-ls" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="sec-inference-ls"><span class="header-section-number">6.3</span> Inferences for least-squares parameters</h2>
<p>If <span class="math inline">\epsilon_i</span> in <a href="#eq-linear-model" class="quarto-xref">Equation&nbsp;<span>6.2</span></a> is assumed to be normally distributed, then we can derive the sampling distributions of the estimators <span class="math inline">\widehat{\beta}_0</span> and <span class="math inline">\widehat{\beta}_1.</span> Hence, we can use these sampling distributions to make inferences about the parameters <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1.</span></p>
<p>Provided iid <span class="math inline">\epsilon_i \mid X_i \sim \mathsf{N}(0, \sigma^2),</span> the least-squares estimators possess the following properties.</p>
<ol type="1">
<li>Both <span class="math inline">\widehat{\beta}_0</span> and <span class="math inline">\widehat{\beta}_1</span> are normally distributed.</li>
<li>Both <span class="math inline">\widehat{\beta}_0</span> and <span class="math inline">\widehat{\beta}_1</span> are unbiased, i.e., <span class="math inline">\mathop{\mathrm{\mathbf{E}}}[\widehat{\beta}_i] = \beta_i</span> for <span class="math inline">i = 0,1.</span></li>
<li><span class="math inline">\mathop{\mathrm{Var}}[\widehat{\beta}_0] = c_{00} \sigma^2</span> where <span class="math inline">c_{00} = \sum_{i=1}^m x_i^2 / (m S_{xx}).</span></li>
<li><span class="math inline">\mathop{\mathrm{Var}}[\widehat{\beta}_1] = c_{11} \sigma^2</span> where <span class="math inline">c_{11} = 1/S_{xx}.</span></li>
<li><span class="math inline">\mathop{\mathrm{Cov}}[\widehat{\beta}_0, \widehat{\beta}_1] = c_{01} \sigma^2</span> where <span class="math inline">c_{01} = - \overline{x} / S_{xx}.</span></li>
</ol>
<p>These properties can be determined by working directly from <a href="#eq-ls-slope" class="quarto-xref">Equation&nbsp;<span>6.5</span></a> and <a href="#eq-ls-intercept" class="quarto-xref">Equation&nbsp;<span>6.6</span></a>.</p>
<div id="prp-htest-ls-betas" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 6.1</strong></span> Consider <span class="math inline">H_0 : \beta_i = \beta_{i0}.</span> The test statistic is <span id="eq-htest-ls-betas-statistic"><span class="math display">
T = \frac{\widehat{\beta}_i - \beta_{i0}}{S\sqrt{c_{ii}}} \,.
\tag{6.8}</span></span></p>
<p>For a hypothesis test at level <span class="math inline">\alpha,</span> we use the following procedure:</p>
<p>If <span class="math inline">H_a : \beta_i &gt; \beta_{i0},</span> then <span class="math inline">P</span>-value is the area under <span class="math inline">\mathsf{t}(m-2)</span> to the right of <span class="math inline">t.</span></p>
<p>If <span class="math inline">H_a : \beta_i &lt; \beta_{i0},</span> tthen <span class="math inline">P</span>-value is the area under <span class="math inline">\mathsf{t}(m-2)</span> to the left of <span class="math inline">t.</span></p>
<p>If <span class="math inline">H_a : \beta_i \neq \beta_{i0},</span> then <span class="math inline">P</span>-value is twice the area under <span class="math inline">\mathsf{t}(m-2)</span> to the right of <span class="math inline">|t|.</span></p>
</div>
<p>A confidence interval for <span class="math inline">\beta_i,</span> based on the statistic <a href="#eq-htest-ls-betas-statistic" class="quarto-xref">Equation&nbsp;<span>6.8</span></a>, can be given following the procedures in <a href="03-infer-single-sample.html" class="quarto-xref"><span>Chapter 3</span></a>.</p>
<div id="prp-ci-ls-betas" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 6.2</strong></span> A <span class="math inline">100(1-\alpha)\%</span> CI for <span class="math inline">\beta_i</span> is given by <span class="math display">
\widehat{\beta}_i \pm t_{\alpha/2, m-2} S \sqrt{c_{ii}} \,.
</span></p>
</div>
</section>
<section id="sec-correlation" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="sec-correlation"><span class="header-section-number">6.4</span> Correlation</h2>
<p>Let <span class="math inline">(X_1, Y_1), \dots, (X_m, Y_m)</span> denote a random sample from a bivariate normal distribution with <span class="math inline">\mathop{\mathrm{\mathbf{E}}}[X_i] = \mu_X,</span> <span class="math inline">\mathop{\mathrm{\mathbf{E}}}[Y_i] = \mu_Y,</span> <span class="math inline">\mathop{\mathrm{Var}}[X_i] = \sigma_X^2,</span> <span class="math inline">\mathop{\mathrm{Var}}[Y_i] = \sigma_Y^2,</span> and correlation coefficient <span class="math inline">\rho.</span> The sample correlation coefficient is given by, <span id="eq-sample-correlation-statistic"><span class="math display">
r = \frac{\sum_{i=1}^m (X_i - \overline{X})(Y_i - \overline{Y})}{\sqrt{\sum_{i=1}^m (X_i - \overline{X})^2 \sum_{i=1}^m (Y_i - \overline{Y})^2}}\,,
\tag{6.9}</span></span> which can be rewritten in terms of <span class="math inline">S_{xx},</span> <span class="math inline">S_{xy},</span> and <span class="math inline">S_{yy}</span>: <span class="math display">
r = \frac{S_{xy}}{\sqrt{S_{xx}S_{yy}}} = \widehat{\beta}_1 \sqrt{\frac{S_{xx}}{S_{yy}}}\,,
</span> using <a href="#eq-ls-slope" class="quarto-xref">Equation&nbsp;<span>6.5</span></a> and we see that <span class="math inline">r</span> and <span class="math inline">\widehat{\beta}_1</span> have the same sign. A <span class="math inline">|r|</span> close to <span class="math inline">1</span> means that the regression line is a good fit to the data, and, similarly, an <span class="math inline">|r|</span> close to <span class="math inline">0</span> means a poor fit to the data. Note that the correlation coefficient (and the least squares regression) are only suitable for describing <em>linear</em> relationships; a nonlinear relationship can also yield <span class="math inline">r</span> near zero (see <a href="#fig-linear-model-correlation" class="quarto-xref">Figure&nbsp;<span>6.4</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-linear-model-correlation" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linear-model-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-linear-models_files/figure-html/fig-linear-model-correlation-1.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linear-model-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.4: Correlations range from <span class="math inline">-1</span> to <span class="math inline">1</span> with <span class="math inline">|r|=1</span> indicating a strong linear relationship and <span class="math inline">r</span> near zero indicating the absence of a linear relationship.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="prediction-using-linear-models" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="prediction-using-linear-models"><span class="header-section-number">6.5</span> Prediction using linear models</h2>
<p>Once a model is fit, it can be used to predict a value of <span class="math inline">y</span> for a given <span class="math inline">x.</span> However, the model only gives the most likely value of <span class="math inline">y</span>; a corresponding prediction interval is usually more appropriate.</p>
<div id="prp-prediction-interval" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 6.3</strong></span> A <span class="math inline">100(1-\alpha)\%</span> prediction interval for an actual value of <span class="math inline">Y</span> when <span class="math inline">x = x^*</span> is given by <span class="math display">
(\widehat{\beta}_0 + \widehat{\beta}_1 x^*) \pm t_{\alpha/2, m-2} S \sqrt{1 + \frac{1}{n} + \frac{(x^* - \overline{x})^2}{S_{xx}}} \,.
</span></p>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prediction versus confidence intervals
</div>
</div>
<div class="callout-body-container callout-body">
<p>The prediction interval is different from the confidence interval for expected <span class="math inline">Y.</span> Note that the length of the <em>confidence interval</em> for <span class="math inline">\mathop{\mathrm{\mathbf{E}}}[Y]</span> when <span class="math inline">x=x^*</span> is given by <span class="math display">
2 \cdot t_{\alpha/2} S  \sqrt{\frac{1}{n} + \frac{(x^* - \overline{x})^2}{S_{xx}}}
</span> whereas the length for the <em>prediction interval</em> of <span class="math inline">Y</span> is <span class="math display">
2 \cdot t_{\alpha/2} S  \sqrt{1 + \frac{1}{n} + \frac{(x^* - \overline{x})^2}{S_{xx}}} \,.
</span> Thus the prediction intervals for an actual value of <span class="math inline">Y</span> are longer than the confidence intervals for <span class="math inline">\mathop{\mathrm{\mathbf{E}}}[Y]</span> if both are determined for the same value <span class="math inline">x^*.</span></p>
</div>
</div>
<p>The linear model <span class="math display">
\mathop{\mathrm{\mathbf{E}}}[ Y \mid X = x ] = \beta_0 + \beta_1 x \,,
</span> assumes that the conditional expectation of <span class="math inline">Y</span> for a fixed value of <span class="math inline">X</span> is a linear function of the <span class="math inline">x</span> value. If we assume that <span class="math inline">(X,Y)</span> has a bivariate normal distribution, then <span class="math display">
\beta_1 = \frac{\sigma_Y}{\sigma_X} \rho \,,
</span> and thus, for the simple hypothesis tests we have considered (<a href="02-basics-stat-infer.html#tbl-htest-null-alt-forms" class="quarto-xref">Table&nbsp;<span>2.2</span></a>), statistical tests for <span class="math inline">\beta_1</span> and <span class="math inline">\rho</span> are equivalent.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/dundeemath\.github\.io\/MA22004");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./05-anova.html" class="pagination-link" aria-label="Analysis of variance">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Analysis of variance</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./07-categorical-data.html" class="pagination-link" aria-label="Categorical data">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Categorical data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024, Eric Hall (University of Dundee)</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/dundeemath/MA22004/edit/master/06-linear-models.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/dundeemath/MA22004/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>