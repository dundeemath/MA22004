<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Analysis of variance (ANOVA) | MA22004 – Statistics and Probability II</title>
  <meta name="description" content="Course guide and course notes for MA22004 - Statistics and Probability II. Division of Mathematics, University of Dundee." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Analysis of variance (ANOVA) | MA22004 – Statistics and Probability II" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://dundeemath.github.io/MA22004" />
  
  <meta property="og:description" content="Course guide and course notes for MA22004 - Statistics and Probability II. Division of Mathematics, University of Dundee." />
  <meta name="github-repo" content="dundeemath/MA22004" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Analysis of variance (ANOVA) | MA22004 – Statistics and Probability II" />
  
  <meta name="twitter:description" content="Course guide and course notes for MA22004 - Statistics and Probability II. Division of Mathematics, University of Dundee." />
  

<meta name="author" content="Dr Eric Hall" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inference-two-samples.html"/>
<link rel="next" href="linear-models.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">MA22004</a></li>

<li class="divider"></li>
<li class="part"><span><b>Course Documents</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-your-instructor"><i class="fa fa-check"></i>About your instructor</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html"><i class="fa fa-check"></i>Course Guide</a>
<ul>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-organization"><i class="fa fa-check"></i>Organisation</a></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-timetable"><i class="fa fa-check"></i>Timetable</a></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-prerecs"><i class="fa fa-check"></i>Pre-requisites</a></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-syllabus"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-books"><i class="fa fa-check"></i>Recommended Books</a></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-assessment"><i class="fa fa-check"></i>Assessment</a>
<ul>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-assessment-coursework"><i class="fa fa-check"></i>Coursework</a></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-assessment-exams"><i class="fa fa-check"></i>Examinations (Class Tests)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-commitment"><i class="fa fa-check"></i>Your Commitment</a></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-calcs"><i class="fa fa-check"></i>Approved Calculators</a></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-support"><i class="fa fa-check"></i>Study Support</a></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-disability"><i class="fa fa-check"></i>Disability</a></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-honesty"><i class="fa fa-check"></i>Academic Honesty</a></li>
<li class="chapter" data-level="" data-path="cg.html"><a href="cg.html#cg-questionaire"><i class="fa fa-check"></i>End of Module Questionaire</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="labs.html"><a href="labs.html"><i class="fa fa-check"></i>Lab Guide</a></li>
<li class="chapter" data-level="" data-path="deadlines.html"><a href="deadlines.html"><i class="fa fa-check"></i>Deadlines</a></li>
<li class="chapter" data-level="" data-path="instructions.html"><a href="instructions.html"><i class="fa fa-check"></i>Instructions</a>
<ul>
<li class="chapter" data-level="" data-path="instructions.html"><a href="instructions.html#gradescope-class-test-submissions"><i class="fa fa-check"></i>Gradescope Class Test Submissions</a>
<ul>
<li class="chapter" data-level="" data-path="instructions.html"><a href="instructions.html#equipment"><i class="fa fa-check"></i>Equipment you will need</a></li>
<li class="chapter" data-level="" data-path="instructions.html"><a href="instructions.html#workflow"><i class="fa fa-check"></i>Submission workflow</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="instructions.html"><a href="instructions.html#using-blackboard"><i class="fa fa-check"></i>Using Blackboard</a></li>
</ul></li>
<li class="part"><span><b>Course Notes</b></span></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i>Preliminaries</a>
<ul>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#notation"><i class="fa fa-check"></i>Notation</a></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html#abbreviations"><i class="fa fa-check"></i>Abbreviations</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="sampling-distributions.html"><a href="sampling-distributions.html"><i class="fa fa-check"></i><b>1</b> Sampling distributions</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sampling-distributions.html"><a href="sampling-distributions.html#normal-distribution"><i class="fa fa-check"></i><b>1.1</b> Normal distribution</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="sampling-distributions.html"><a href="sampling-distributions.html#facts-normals"><i class="fa fa-check"></i><b>1.1.1</b> Some useful facts about normal variates</a></li>
<li class="chapter" data-level="1.1.2" data-path="sampling-distributions.html"><a href="sampling-distributions.html#empirical-rule-68-95-99.7-rule"><i class="fa fa-check"></i><b>1.1.2</b> Empirical rule (<span class="math inline">\(68-95-99.7\)</span> rule)</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sampling-distributions.html"><a href="sampling-distributions.html#t-distribution"><i class="fa fa-check"></i><b>1.2</b> <span class="math inline">\(\mathsf{t}\)</span> distribution</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sampling-distributions.html"><a href="sampling-distributions.html#facts-t"><i class="fa fa-check"></i><b>1.2.1</b> Properties of <span class="math inline">\(\mathsf{t}\)</span> distributions</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sampling-distributions.html"><a href="sampling-distributions.html#chisq-distribution"><i class="fa fa-check"></i><b>1.3</b> <span class="math inline">\(\chi^2\)</span> distribution</a></li>
<li class="chapter" data-level="1.4" data-path="sampling-distributions.html"><a href="sampling-distributions.html#F-distribution"><i class="fa fa-check"></i><b>1.4</b> <span class="math inline">\(\mathsf{F}\)</span> distribution</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistical-inference.html"><a href="statistical-inference.html"><i class="fa fa-check"></i><b>2</b> Basics of statistical inference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistical-inference.html"><a href="statistical-inference.html#point-estimation"><i class="fa fa-check"></i><b>2.1</b> Point estimation</a></li>
<li class="chapter" data-level="2.2" data-path="statistical-inference.html"><a href="statistical-inference.html#confidence-intervals"><i class="fa fa-check"></i><b>2.2</b> Confidence intervals</a></li>
<li class="chapter" data-level="2.3" data-path="statistical-inference.html"><a href="statistical-inference.html#hypothesis-testing"><i class="fa fa-check"></i><b>2.3</b> Hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="inference-single-sample.html"><a href="inference-single-sample.html"><i class="fa fa-check"></i><b>3</b> Inferences based on a single sample</a>
<ul>
<li class="chapter" data-level="3.1" data-path="inference-single-sample.html"><a href="inference-single-sample.html#estimating-means"><i class="fa fa-check"></i><b>3.1</b> Estimating means</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="inference-single-sample.html"><a href="inference-single-sample.html#mean-normal-var-known"><i class="fa fa-check"></i><b>3.1.1</b> Mean of a normal population with known variance</a></li>
<li class="chapter" data-level="3.1.2" data-path="inference-single-sample.html"><a href="inference-single-sample.html#mean-large-sample"><i class="fa fa-check"></i><b>3.1.2</b> Mean of a population with unknown variance (large-sample)</a></li>
<li class="chapter" data-level="3.1.3" data-path="inference-single-sample.html"><a href="inference-single-sample.html#mean-normal-var-unknown"><i class="fa fa-check"></i><b>3.1.3</b> Mean of a normal population with unknown variance</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="inference-single-sample.html"><a href="inference-single-sample.html#estimating-proportions"><i class="fa fa-check"></i><b>3.2</b> Estimating proportions</a></li>
<li class="chapter" data-level="3.3" data-path="inference-single-sample.html"><a href="inference-single-sample.html#estimating-variances"><i class="fa fa-check"></i><b>3.3</b> Estimating variances</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inference-two-samples.html"><a href="inference-two-samples.html"><i class="fa fa-check"></i><b>4</b> Inferences based on two samples</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inference-two-samples.html"><a href="inference-two-samples.html#compare-means"><i class="fa fa-check"></i><b>4.1</b> Comparing means</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="inference-two-samples.html"><a href="inference-two-samples.html#compare-means-normpops-vars-known"><i class="fa fa-check"></i><b>4.1.1</b> Comparing means of normal populations when variances are known</a></li>
<li class="chapter" data-level="4.1.2" data-path="inference-two-samples.html"><a href="inference-two-samples.html#compare-means-large-samples"><i class="fa fa-check"></i><b>4.1.2</b> Comparing means when the sample sizes are large</a></li>
<li class="chapter" data-level="4.1.3" data-path="inference-two-samples.html"><a href="inference-two-samples.html#compare-means-normpops-vars-unknown"><i class="fa fa-check"></i><b>4.1.3</b> Comparing means of normal populations when variances are unknown and the sample size is small</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="inference-two-samples.html"><a href="inference-two-samples.html#compare-paired-samples"><i class="fa fa-check"></i><b>4.2</b> Comparing paired samples</a></li>
<li class="chapter" data-level="4.3" data-path="inference-two-samples.html"><a href="inference-two-samples.html#compare-proportions"><i class="fa fa-check"></i><b>4.3</b> Comparing proportions</a></li>
<li class="chapter" data-level="4.4" data-path="inference-two-samples.html"><a href="inference-two-samples.html#compare-variances"><i class="fa fa-check"></i><b>4.4</b> Comparing variances</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>5</b> Analysis of variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="anova.html"><a href="anova.html#anova-single-factor-test"><i class="fa fa-check"></i><b>5.1</b> Single factor ANOVA test</a></li>
<li class="chapter" data-level="5.2" data-path="anova.html"><a href="anova.html#anova-ci"><i class="fa fa-check"></i><b>5.2</b> Confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>6</b> Linear regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="linear-models.html"><a href="linear-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.1</b> Simple linear regression models</a></li>
<li class="chapter" data-level="6.2" data-path="linear-models.html"><a href="linear-models.html#ls-estimate-var"><i class="fa fa-check"></i><b>6.2</b> Estimating <span class="math inline">\(\sigma^2\)</span> for linear regressions</a></li>
<li class="chapter" data-level="6.3" data-path="linear-models.html"><a href="linear-models.html#inference-ls"><i class="fa fa-check"></i><b>6.3</b> Inferences for least-squares parameters</a></li>
<li class="chapter" data-level="6.4" data-path="linear-models.html"><a href="linear-models.html#correlation"><i class="fa fa-check"></i><b>6.4</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="categorical-data.html"><a href="categorical-data.html"><i class="fa fa-check"></i><b>7</b> Categorical data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="categorical-data.html"><a href="categorical-data.html#multinomial-experiments"><i class="fa fa-check"></i><b>7.1</b> Multinomial experiments</a></li>
<li class="chapter" data-level="7.2" data-path="categorical-data.html"><a href="categorical-data.html#goodness-of-fit-tests"><i class="fa fa-check"></i><b>7.2</b> Goodness-of-fit for a single factor</a></li>
<li class="chapter" data-level="7.3" data-path="categorical-data.html"><a href="categorical-data.html#test-for-independence-of-factors"><i class="fa fa-check"></i><b>7.3</b> Test for independence of factors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="quality-control.html"><a href="quality-control.html"><i class="fa fa-check"></i><b>8</b> Quality control</a>
<ul>
<li class="chapter" data-level="8.1" data-path="quality-control.html"><a href="quality-control.html#control-charts"><i class="fa fa-check"></i><b>8.1</b> Control charts</a></li>
</ul></li>
<li class="part"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="" data-path="curated-content.html"><a href="curated-content.html"><i class="fa fa-check"></i>Curated Content</a>
<ul>
<li class="chapter" data-level="" data-path="curated-content.html"><a href="curated-content.html#investigation-0"><i class="fa fa-check"></i>Investigation 0</a></li>
<li class="chapter" data-level="" data-path="curated-content.html"><a href="curated-content.html#investigation-1"><i class="fa fa-check"></i>Investigation 1</a></li>
<li class="chapter" data-level="" data-path="curated-content.html"><a href="curated-content.html#investigation-2"><i class="fa fa-check"></i>Investigation 2</a></li>
<li class="chapter" data-level="" data-path="curated-content.html"><a href="curated-content.html#investigation-3"><i class="fa fa-check"></i>Investigation 3</a></li>
<li class="chapter" data-level="" data-path="curated-content.html"><a href="curated-content.html#investigation-4"><i class="fa fa-check"></i>Investigation 4</a></li>
<li class="chapter" data-level="" data-path="curated-content.html"><a href="curated-content.html#investigation-5"><i class="fa fa-check"></i>Investigation 5</a></li>
<li class="chapter" data-level="" data-path="curated-content.html"><a href="curated-content.html#investigation-6"><i class="fa fa-check"></i>Investigation 6</a></li>
<li class="chapter" data-level="" data-path="curated-content.html"><a href="curated-content.html#investigation-7"><i class="fa fa-check"></i>Investigation 7</a></li>
<li class="chapter" data-level="" data-path="curated-content.html"><a href="curated-content.html#investigation-8"><i class="fa fa-check"></i>Investigation 8</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://uod.ac.uk/sig-home" rel="nofollow"><img width="73" height="73" src="https://www.dundee.ac.uk/media/dundeewebsite/themes/brandnewhope/img/university-of-dundee-email-favicon.png" alt="University of Dundee shield logo"> </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MA22004 – Statistics and Probability II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">

<div id="anova" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Analysis of variance (ANOVA)</h1>
<p>Analysis of variance, shortened as ANOVA, is a collection of statistical models and estimation procedures for analyzing the variation among different groups. In particular, a single-factor ANOVA provides a hypothesis test regarding the equality of two or more population means, thereby generalizing the one-sample and two-sample <span class="math inline">\(\mathsf{t}\)</span> tests considered in Sections <a href="inference-single-sample.html#mean-normal-var-unknown">3.1.3</a> and <a href="inference-two-samples.html#compare-means-normpops-vars-unknown">4.1.3</a>.</p>
<div id="anova-single-factor-test" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Single factor ANOVA test</h2>
<p>Suppose that we have <span class="math inline">\(k\)</span> normally distributed populations<a href="#fn26" class="footnote-ref" id="fnref26"><sup>26</sup></a> with different means <span class="math inline">\(\mu_1, \dots, \mu_k\)</span> and equal variances <span class="math inline">\(\sigma^2\)</span>. We denote the rv for the <span class="math inline">\(j\)</span>th measurement taken from the <span class="math inline">\(i\)</span>th population by <span class="math inline">\(X_{ij}\)</span> and the corresponding sample observation by <span class="math inline">\(x_{ij}\)</span>. For samples of size <span class="math inline">\(m_1, \dots, m_k\)</span>, we denote the sample means
<span class="math display">\[\begin{equation*}
 \overline{X}_i = \frac{1}{m_i} \sum_{j=1}^{m_i} X_{ij}\,, 
\end{equation*}\]</span>
and sample variances
<span class="math display">\[\begin{equation*}
 S_i^2 = \frac{1}{m_i - 1} \sum_{j=1}^{m_i} (X_{ij} - \overline{X}_{i})^2\,,
\end{equation*}\]</span>
for each <span class="math inline">\(i = 1, \dots, k\)</span>; likewise, we denote the associated point estimates for the sample means <span class="math inline">\(\overline{x}_1, \dots, \overline{x}_k\)</span> and the sample variances <span class="math inline">\(s_1^2, \dots, s_k^2\)</span>. The average over all observations <span class="math inline">\(m = \sum m_i\)</span>, called the <strong>grand mean</strong>, is denoted by
<span class="math display">\[\begin{equation*}
 \overline{X} = \frac{1}{m} \sum_{i=1}^k \sum_{j=1}^{m_i} X_{ij}\,.
\end{equation*}\]</span>
The sample variances <span class="math inline">\(s_i^2\)</span>, and hence the sample standard deviations, will generally vary even when the <span class="math inline">\(k\)</span> populations share the same variance; a rule of thumb is that the equality of variances is reasonable if the largest <span class="math inline">\(s_i\)</span> is not much more than two times the smallest.</p>
<p>We wish to test the equality of the population means, given by the null hypothesis,
<span class="math display">\[\begin{equation*}
 H_0 : \mu_1 = \mu_2 = \cdots = \mu_k\,,
\end{equation*}\]</span>
versus the alternative hypothesis,
<span class="math display">\[\begin{equation*}
 H_a : \text{at least two}\; \mu_i \; \text{differ}\,.
\end{equation*}\]</span>
Note that if <span class="math inline">\(k=3\)</span> then <span class="math inline">\(H_0\)</span> is true only if all three means are the same, i.e., <span class="math inline">\(\mu_1 = \mu_1 = \mu_3\)</span>, but there are a number of ways which the alternative might hold: <span class="math inline">\(\mu_1 \neq \mu_2 = \mu_3\)</span> or <span class="math inline">\(\mu_1 = \mu_2 \neq \mu_3\)</span> or <span class="math inline">\(\mu_1 = \mu_3 \neq \mu_2\)</span> or <span class="math inline">\(\mu_1 \neq \mu_2 \neq \mu_3\)</span>.</p>
<p>The test procedure is based on comparing a measure of difference in variation among the sample means, i.e., the variation between <span class="math inline">\(x_i\)</span>’s, to a measure of variation within each sample.</p>

<div class="definition">
<span id="def:mstr-mse" class="definition"><strong>Definition 5.1  </strong></span>The <strong>mean square for treatments</strong> is
<span class="math display">\[\begin{equation*}
 \mathsf{MSTr} = \frac{1}{k-1} \sum_{i=1}^k m_i (\overline{X}_i - \overline{X})^2\,,
\end{equation*}\]</span>
and the <strong>mean square error</strong> is
<span class="math display">\[\begin{equation*}
 \mathsf{MSE} = \frac{1}{m-k} \sum_{i=1}^k (m_i - 1) S_i^2 \,.
\end{equation*}\]</span>
The <span class="math inline">\(\mathsf{MSTr}\)</span> and <span class="math inline">\(\mathsf{MSE}\)</span> are statistics that measure, respectively, the variation among sample means and the variation within samples. We will also use <span class="math inline">\(\mathsf{MSTr}\)</span> and <span class="math inline">\(\mathsf{MSE}\)</span> to denote calculated values of these statistics.
</div>

<div class="proposition">
<span id="prp:htest-anova" class="proposition"><strong>Proposition 5.1  </strong></span>The test statistic
<span class="math display">\[\begin{equation*}
F = \frac{\mathsf{MSTr}}{\mathsf{MSE}} 
\end{equation*}\]</span>
is the appropriate test statistic for the single-factor ANOVA problem involving <span class="math inline">\(k\)</span> populations (or treatments) with a random sample of size <span class="math inline">\(m_1, \dots, m_k\)</span> from each. When <span class="math inline">\(H_0\)</span> is true,
<span class="math display">\[\begin{equation*}
F \sim \mathsf{F}(\nu_1 = k-1, \nu_2 = m - k)\,.
\end{equation*}\]</span>
In the present context a large test statistic value is more constradictory to <span class="math inline">\(H_0\)</span> than a smaller value, therefore the test is upper-tailed, i.e., consider the area <span class="math inline">\(F_\alpha\)</span> to the right of the critical value <span class="math inline">\(F_{\alpha, \nu_1, \nu_2}\)</span>. We reject <span class="math inline">\(H_0\)</span> if the value of the test statistic <span class="math inline">\(F &gt; F_\alpha\)</span>.
</div>

<div class="example">
<span id="exm:anova" class="example"><strong>Example 5.1  </strong></span>Consider the average salary data from lcocal councils in Table <a href="anova.html#tab:anova-samples-stats">5.1</a>. Is the expected average salary in each nation the same at the <span class="math inline">\(5\%\)</span> level?
</div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:anova-samples-stats">Table 5.1: </span><strong>Average Salary Data</strong> reported from <span class="math inline">\(20\)</span> local councils.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nation
</th>
<th style="text-align:left;">
Average salaries (’000 £)
</th>
<th style="text-align:center;">
Size <span class="math inline">\((m_i)\)</span>
</th>
<th style="text-align:center;">
Sample Mean <span class="math inline">\((\overline{x}_i)\)</span>
</th>
<th style="text-align:center;">
Sample SD <span class="math inline">\((s_i)\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
England
</td>
<td style="text-align:left;">
17, 12, 18, 13, 15, 12
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
14.5
</td>
<td style="text-align:center;">
2.588
</td>
</tr>
<tr>
<td style="text-align:left;">
N Ireland
</td>
<td style="text-align:left;">
11, 7, 9, 13
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
10.0
</td>
<td style="text-align:center;">
2.582
</td>
</tr>
<tr>
<td style="text-align:left;">
Scotland
</td>
<td style="text-align:left;">
15, 10, 13, 14, 13
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
13.0
</td>
<td style="text-align:center;">
1.871
</td>
</tr>
<tr>
<td style="text-align:left;">
Wales
</td>
<td style="text-align:left;">
10, 12, 8, 7, 9
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
9.2
</td>
<td style="text-align:center;">
1.924
</td>
</tr>
</tbody>
</table>
<div class="tipblock">
<p>Table <a href="anova.html#tab:anova-samples-stats">5.1</a> presents the <strong>Average Salary Data</strong> (in thousands of pounds) reported from 20 local councils classified by nation (England, N Ireland, Scotland, and Wales). The sample means together with the sample standard deviations are summarized in the table as well as presented using using box plots in Figure <a href="anova.html#fig:anova-samples-boxplots">5.1</a>.</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:anova-samples-boxplots"></span>
<img src="ma22004_files/figure-html/anova-samples-boxplots-1.svg" alt="Box plots of the average mean salary data in Table \@ref(tab:anova-samples-stats) indicate five summary statistics: the median, two hinges (first and third quartiles) and two whiskers (extending from the hinge to the most extreme data point within $1.5 \cdot \mathsf{IQR}$)." width="768" />
<p class="caption">
Figure 5.1: Box plots of the average mean salary data in Table <a href="anova.html#tab:anova-samples-stats">5.1</a> indicate five summary statistics: the median, two hinges (first and third quartiles) and two whiskers (extending from the hinge to the most extreme data point within <span class="math inline">\(1.5 \cdot \mathsf{IQR}\)</span>).
</p>
</div>
<p>For <span class="math inline">\(\alpha = 0.05\)</span>, we compute the upper-tail area <span class="math inline">\(F_{0.05}\)</span> i.e. to the right of the critical value <span class="math inline">\(F_{0.05, 3, 16}\)</span> by consulting a statistical table or by using <code>r</code> to find <span class="math inline">\(F_{0.05} = 3.2388715\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="anova.html#cb9-1" aria-hidden="true"></a><span class="co"># alt: qf(.05, df1 = 3, df2 = 16, lower.tail = FALSE)</span></span>
<span id="cb9-2"><a href="anova.html#cb9-2" aria-hidden="true"></a><span class="kw">qf</span>(<span class="dv">1</span><span class="fl">-.05</span>, <span class="dt">df1 =</span> <span class="dv">4-1</span>, <span class="dt">df2 =</span> <span class="dv">20-4</span>) </span></code></pre></div>
<pre><code>[1] 3.238872</code></pre>
<p>The grand mean is
<span class="math display">\[\begin{equation*}
 \overline{x} = \frac{17 + 12 + 18 + \cdots + 8 + 7 + 9}{20} = 11.9\,,
\end{equation*}\]</span>
and hence the variation among sample means is given by,
<span class="math display">\[\begin{equation*}
\begin{aligned}
 \mathsf{MSTr} &amp;= \frac{1}{4-1} \left(m_1(\overline{x}_1 - \overline{x})^2 + \cdots + m_4 (\overline{x}_4 - \overline{x})^2\right) \\
 &amp;= \left(6 (14.5-11.9)^2 + 4(10.0 - 11.9)^2 + 5(13.0-11.9)^2 + 5 ( 9.2 - 11.9)^2\right) / 3 \\
 &amp;= 32.5 \,.
\end{aligned}
\end{equation*}\]</span>
The mean square error is
<span class="math display">\[\begin{equation*}
 \begin{aligned}
 \mathsf{MSE} &amp; = \frac{1}{20-4} \left((m_1 - 1)s_1^2 + \cdots (m_4-1)s_4^2\right)\\ 
  &amp;= \frac{5(2.588)^2 + 3(2.582)^2 + 4(1.871)^2 + 4(1.924)^2}{16} \\
  &amp;= 5.14366
 \end{aligned}
\end{equation*}\]</span>
yielding the test statistic value
<span class="math display">\[\begin{equation*}
 F = \frac{\mathsf{MSTr}}{\mathsf{MSE}} = \frac{32.5}{5.14366} 
 = 6.3184581 \,.
\end{equation*}\]</span>
Since <span class="math inline">\(F &gt; F_\alpha\)</span> we reject <span class="math inline">\(H_0\)</span>. The data does not support they hypothesis that the mean salaries in each nation are identical at the <span class="math inline">\(5\%\)</span> level. <span class="math inline">\(\lozenge\)</span></p>
</div>
<div id="anova-ci" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Confidence intervals</h2>
<p>In Section <a href="inference-two-samples.html#compare-means">4.1</a> we gave a CI for comparing population means that involved the difference <span class="math inline">\(\mu_X - \mu_Y\)</span>. In some settings, we would like to give CIs for more complicated functions of population means <span class="math inline">\(\mu_i\)</span>. Let
<span class="math display">\[\begin{equation*}
 \theta = \sum_{i=1}^k c_i \mu_i\,,
\end{equation*}\]</span>
for constants <span class="math inline">\(c_i\)</span>. As we assume the <span class="math inline">\(X_ij\)</span> are normally distributed with <span class="math inline">\(\E[X_{ij}] = \mu_i\)</span> and <span class="math inline">\(\Var[X_{ij}] = \sigma^2\)</span>, the estimator
<span class="math display">\[\begin{equation*}
 \widehat{\theta} = \sum_{i=1}^k c_i \overline{X}_{i}\,,
\end{equation*}\]</span>
is normally distributed with
<span class="math display">\[\begin{equation*}
 \Var[\widehat{\theta}] - \sum_{i=1}^k c_i^2 \Var[\overline{X}_i] = \sigma^2 \sum_{i=1}^{k} \frac{c_i}{m_i}\,.
\end{equation*}\]</span>
Estimating <span class="math inline">\(\sigma^2\)</span> by the <span class="math inline">\(\mathsf{MSE}\)</span> and forming <span class="math inline">\(\widehat{\sigma}_{\widehat{\theta}}\)</span> results in a <span class="math inline">\(\mathsf{t}\)</span> variable
<span class="math display">\[\begin{equation*}
 \frac{\widehat{\theta} - \theta}{\widehat{\sigma}_{\widehat{\theta}}}\,.
\end{equation*}\]</span></p>

<div class="proposition">
<span id="prp:ci-anova" class="proposition"><strong>Proposition 5.2  </strong></span>A <span class="math inline">\(100(1-\alpha)\%\)</span> CI for <span class="math inline">\(\sum c_i \mu_i\)</span> is given by
<span class="math display">\[\begin{equation*}
 \sum_{i=1}^k c_i \overline{x}_i \pm t_{\alpha/2, m-k} \sqrt{\mathsf{MSE} \sum_{i=1}^k \frac{c_i}{m_i}}\,.
\end{equation*}\]</span>
</div>

<div class="example">
<span id="exm:anova-ci" class="example"><strong>Example 5.2  </strong></span>Determine a <span class="math inline">\(90\%\)</span> CI for the difference in mean average salary for councils in Scotland and England, based on the data available in Table <a href="anova.html#tab:anova-samples-stats">5.1</a>
</div>
<p>For <span class="math inline">\(\alpha = 0.10\)</span>, the critical value <span class="math inline">\(t_{0.05, 16} = 1.7458837\)</span> is found by looking in a table of <span class="math inline">\(\mathsf{t}\)</span> critical values or by using <code>r</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="anova.html#cb11-1" aria-hidden="true"></a><span class="co"># alt: qt(0.1/2, 16, lower.tail = FALSE)</span></span>
<span id="cb11-2"><a href="anova.html#cb11-2" aria-hidden="true"></a><span class="kw">qt</span>(<span class="dv">1</span><span class="fl">-0.1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> <span class="dv">20</span> <span class="op">-</span><span class="st"> </span><span class="dv">4</span>) </span></code></pre></div>
<pre><code>[1] 1.745884</code></pre>
<p>Then for the function <span class="math inline">\(\overline{x}_2 - \overline{x_1}\)</span>,
<span class="math display">\[\begin{equation*}
\begin{aligned}
(\overline{x}_{Eng} - \overline{x}_{Sco}) \pm&amp; t_{0.05, 16} \sqrt{\mathsf{MSE}} \sqrt{\frac{1}{m_{Eng}} + \frac{1}{m_{Sco}}} \\
&amp; = (14.5 - 13.0) \pm 1.7458837 \sqrt{5.14366} \sqrt{\frac{1}{6} + \frac{1}{5}} \\
&amp; = 1.5 \pm 2.3976575\,.
\end{aligned}
\end{equation*}\]</span>
Thus a <span class="math inline">\(90\%\)</span> confidence interval for <span class="math inline">\(\mu_{Eng} - \mu_{Sco}\)</span> is <span class="math inline">\((-0.8977\,, 3.898)\)</span>. <span class="math inline">\(\lozenge\)</span></p>
<div class="warningblock">
<p>How does the result in Example <a href="anova.html#exm:anova-ci">5.2</a> compare to the <span class="math inline">\(\mathsf{t}\)</span> method in Section <a href="inference-two-samples.html#compare-means-normpops-vars-unknown">4.1.3</a>?</p>
</div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="26">
<li id="fn26"><p>In the context of ANOVA, these <span class="math inline">\(k\)</span> populations are often referred to as <strong>treatment distributions</strong>.<a href="anova.html#fnref26" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inference-two-samples.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dundeemath/MA22004/edit/master/05-anova.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ma22004.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true,
"highlight": "pygments",
"number_sections": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
