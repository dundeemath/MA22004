{
  "hash": "247f3cc96d16fbff4b95a9ef092aa941",
  "result": {
    "engine": "knitr",
    "markdown": "\n\n\n\n\n\n# Quality control {#quality-control}\n\nQuality control is an area of applied statistics that makes interventions to maintain or improve the outcome of industrial processes. Random variations in output processes might negatively impact the quality of a product. We want to identify the sources of random output-process variations that might have *assignable causes*. **Control charts** are a tool that helps us to recognise when industrial processes are no longer controlled so that one might then seek to identify assignable causes. \n\n## Control charts {#control-charts}\n\nThe essential elements of control charting involve specifying a control region and then analysing time-series data. We will specify a baseline value along with an upper and lower control limit and assume that a process is under control unless a test statistic suggests otherwise.^[The default position here will be reminiscent of hypothesis testing.] To construct a control chart, one collects data about a process at fixed points of time and calculates the running value of a quality statistic. Suppose the quality statistic exceeds the upper or lower control limits. In that case, the process is deemed out of control, and the product quality is assumed to be negatively impacted.\n\nThe process of creating a control chart is best illustrated through an extended example, like Example \\@ref(exm:qc-three-sigma) provided below. \n\n\n\n::: {.cell}\n\n```{.example .cell-code}\nHere we consider the typical $3 \\sigma$ control charting for a process mean $\\overline{X}$ based on estimated parameters. That is, we assume the generating process $X$ is normally distributed with unknown parameters $\\mu$ and $\\sigma^2$. We seek to estimate the mean $\\overline{X}$. Our control region is specified to be three standard deviations; the process is in control if it remains within three standard deviations of a baseline value.\n```\n:::\n\n\n\nThe **Beer Data** contains measurements of the features OG, ABV, pH, and IBU for $50$ batches of each of three types of product (Premium Lager, IPA, and Light Lager). We are interested in the IPA's pH value, which influences saccharification. We assume that three batches of IPA are produced per day, and we prepare the data as follows.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nipa <- beer |> \n select(Batch_Id, pH, Beer) |> \n filter(Beer == \"IPA\") |> \n rename(Day = Batch_Id)\nipa$Day[1:48] <- rep(1:16, each = 3)\nipa <- ipa[1:48,]\nm <- 3    # three batches per day\nk <- 16   # number of days\n```\n:::\n\n\n\nWe first observe that the pH measurements are (at least approximately) normal, as seen in the quantile-quantile plot in Figure \\@ref(fig:qc-beer-pH-norm).   \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(ipa, aes(sample = pH)) + stat_qq() + stat_qq_line()\n```\n\n::: {.cell-output-display}\n![Normal quantile-quantile plot of observed pH measurements of the IPA batches in Table \\@ref(tab:qc-beer-data).](08-quality-control_files/figure-pdf/qc-beer-pH-norm-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\nWe consider the data for pH readings from three batches of IPA taken over sixteen days ($k = 16$) presented in Table \\@ref(tab:qc-beer-data). The Table includes the sample mean per day $\\overline{x}$, the sample standard deviation $s$, and the range of values $\\max{x_i} - \\min{x_i}$ per day (each based on $m=3$ batches).   \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nipa_stat <- ipa |> \n group_by(Day) |> \n summarise(observations = list(pH), mean = signif(mean(pH), digits = 4), \n           sd = signif(sd(pH), digits = 4), range = max(pH) - min(pH))\nkbl(ipa_stat, align = \"rlccc\", \n      caption = \"Observations and summary statistics for the **Beer Data**.\",\n      col.names = c('Day', \"pH Observations\", '$\\\\overline{x}$', '$s$', 'Range'), \n    booktabs = T, escape = F) |>\n   kable_styling(latex_options = c(\"striped\", \"hold_position\"))\n```\n\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\caption{\\label{tab:qc-beer-data}Observations and summary statistics for the **Beer Data**.}\n\\centering\n\\begin{tabular}[t]{rlccc}\n\\toprule\nDay & pH Observations & $\\overline{x}$ & $s$ & Range\\\\\n\\midrule\n\\cellcolor{gray!10}{1} & \\cellcolor{gray!10}{4.7, 4.5, 4.9} & \\cellcolor{gray!10}{4.700} & \\cellcolor{gray!10}{0.20000} & \\cellcolor{gray!10}{0.4}\\\\\n2 & 4.0, 4.6, 4.5 & 4.367 & 0.32150 & 0.6\\\\\n\\cellcolor{gray!10}{3} & \\cellcolor{gray!10}{4.7, 3.3, 4.6} & \\cellcolor{gray!10}{4.200} & \\cellcolor{gray!10}{0.78100} & \\cellcolor{gray!10}{1.4}\\\\\n4 & 3.9, 3.5, 4.2 & 3.867 & 0.35120 & 0.7\\\\\n\\cellcolor{gray!10}{5} & \\cellcolor{gray!10}{4.0, 4.7, 3.6} & \\cellcolor{gray!10}{4.100} & \\cellcolor{gray!10}{0.55680} & \\cellcolor{gray!10}{1.1}\\\\\n\\addlinespace\n6 & 4.4, 4.5, 4.1 & 4.333 & 0.20820 & 0.4\\\\\n\\cellcolor{gray!10}{7} & \\cellcolor{gray!10}{4.5, 3.9, 4.8} & \\cellcolor{gray!10}{4.400} & \\cellcolor{gray!10}{0.45830} & \\cellcolor{gray!10}{0.9}\\\\\n8 & 4.0, 4.9, 4.7 & 4.533 & 0.47260 & 0.9\\\\\n\\cellcolor{gray!10}{9} & \\cellcolor{gray!10}{4.3, 4.4, 4.8} & \\cellcolor{gray!10}{4.500} & \\cellcolor{gray!10}{0.26460} & \\cellcolor{gray!10}{0.5}\\\\\n10 & 5.0, 4.5, 3.5 & 4.333 & 0.76380 & 1.5\\\\\n\\addlinespace\n\\cellcolor{gray!10}{11} & \\cellcolor{gray!10}{3.8, 3.7, 3.9} & \\cellcolor{gray!10}{3.800} & \\cellcolor{gray!10}{0.10000} & \\cellcolor{gray!10}{0.2}\\\\\n12 & 5.1, 4.5, 4.5 & 4.700 & 0.34640 & 0.6\\\\\n\\cellcolor{gray!10}{13} & \\cellcolor{gray!10}{4.7, 4.4, 4.1} & \\cellcolor{gray!10}{4.400} & \\cellcolor{gray!10}{0.30000} & \\cellcolor{gray!10}{0.6}\\\\\n14 & 4.0, 4.4, 4.6 & 4.333 & 0.30550 & 0.6\\\\\n\\cellcolor{gray!10}{15} & \\cellcolor{gray!10}{4.0, 3.3, 4.2} & \\cellcolor{gray!10}{3.833} & \\cellcolor{gray!10}{0.47260} & \\cellcolor{gray!10}{0.9}\\\\\n\\addlinespace\n16 & 4.2, 4.2, 4.3 & 4.233 & 0.05774 & 0.1\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n\n\n:::\n:::\n\n\n\nWe estimate the mean  \n\\begin{equation*}\n \\widehat{\\mu} = \\frac{1}{k} \\sum_{i=1}^k \\overline{x}_i \\,,\n\\end{equation*}\nby averaging the means found for the $k$ days and, similarly, estimating the mean of the sample standard deviation,\n\\begin{equation*}\n \\overline{s} = \\frac{1}{k} \\sum_{i=1}^k s_i\\,,\n\\end{equation*}\nby averaging the sample standard deviations for the $k$ days. It can be shown that \n\\begin{equation*}\n \\widehat{\\sigma} = \\frac{\\overline{S}}{a_m} \n\\end{equation*}\nis an unbiased estimator of $\\sigma$ where\n\\begin{equation*}\na_m = \\frac{\\sqrt{2} \\Gamma(m/2)}{\\sqrt{m-1}\\Gamma\\left((n-1)/2\\right)}\\,.\n\\end{equation*}\nThus, we compute the $3\\sigma$ upper and lower control limits, respectively,\n\\begin{equation*}\n \\mathsf{UCL} = \\widehat{\\mu} + 3 \\frac{\\overline{s}}{a_m \\sqrt{m}}\n\\end{equation*}\nand \n\\begin{equation*}\n \\mathsf{LCL} = \\widehat{\\mu} - 3 \\frac{\\overline{s}}{a_m \\sqrt{m}} \\,.\n\\end{equation*}\nThe computations in `r` follow, along with the resulting **control chart** in Figure \\@ref(fig:qc-beer-control-chart).   \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\na <- function(m){ sqrt(2) * gamma(m/2) / (sqrt(m-1) * gamma((m-1)/2)) }\nmuhat = sum(ipa_stat$mean) / k\nsbar = sum(ipa_stat$sd) / k\nlcl = muhat - 3*sbar / (a(m) * sqrt(m))\nucl = muhat + 3*sbar / (a(m) * sqrt(m))\n\nggplot(ipa_stat, aes(x = Day)) + geom_point(aes(y = mean)) + \n geom_hline(aes(yintercept = muhat, color = \"Mean\"), size = lsz) + \n geom_hline(aes(yintercept = lcl, color = \"LCL\"), size = lsz*1.5) + \n geom_hline(aes(yintercept = ucl, color = \"UCL\"), size = lsz*1.5) + ylab(\"pH\") + \n   theme(legend.justification = c(1,1), legend.position = c(1,1),\n         legend.title = element_blank(), \n         legend.box.margin = margin(c(4, 4, 4, 4), unit = \"pt\"))\n```\n\n::: {.cell-output-display}\n![The $3\\sigma$ **control chart** illustrates that with respect to pH the brewing process is in-control over the selected timeframe as the observations fall within the $(\\mathsf{LCL}, \\mathsf{UCL})$ control interval.](08-quality-control_files/figure-pdf/qc-beer-control-chart-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\nFrom Figure \\@ref(fig:qc-beer-control-chart), we observe for each day the process is in-control as the observed mean pH values fall within the control limits $(\\mathsf{LCL}, \\mathsf{UCL})$. If this were not the case, our initial assumption that the process is in control would be violated. The violation of the assumption would require that we seek to identify an assignable cause for the variation. If a cause could be identified, we would need to recompute our control limits with the observations that were out of control removed. $\\lozenge$\n",
    "supporting": [
      "08-quality-control_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}