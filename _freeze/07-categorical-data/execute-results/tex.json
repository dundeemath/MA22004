{
  "hash": "01444c8c601198dfadd72f8e74ad25a2",
  "result": {
    "engine": "knitr",
    "markdown": "\n\n\n\n\n\n# Categorical data {#categorical-data}\n\n## Multinomial experiments\n\nSuppose we have a population divided into $k > 2$ distinct categories. We consider an experiment where we select $m$ individuals (or objects) from the population and categorise each. We denote the population proportion in the $i$th category by $p_i$. If the sample size $m$ is much smaller than the population size $M$ (so that the $m$ trials are independent), this experiment will be approximately *multinomial* with success probability $p_i$ for each category, $i=1, \\dots, k$. \n\nBefore the experiment is performed, we denote the number (or count) of the trials resulting in category $i$ by the rv $N_i$. The expected number of trails that result in category $i$ is given by \n\\begin{equation}\n\\E[N_i] = m p_i\\,, \\quad i=1, \\dots, k\\,.\n(\\#eq:mean-count-multinomial)\n\\end{equation} \nAfter the experiment is performed, we denote the corresponding observed value by $n_i$. Since the trials result in distinct categories, \n\\begin{equation*}\n\\sum_{i=1}^k N_i = \\sum_{i=1}^{k} n_i = m \\,,\n\\end{equation*}\nwhich indicates that, for a given $m$, we only need to observe $k-1$ of the variables to be able to work out what the $k$th variable should be. \n\n## Goodness-of-fit for a single factor {#goodness-of-fit-tests}\n\nWe are interested in making inferences about the proportion parameters $p_i$. Specifically, we will consider the null hypothesis,\n\\begin{equation}\nH_0 : p_1 = p_{10}\\,, p_2 = p_{20}\\,, \\cdots\\,, p_k = p_{k0}\\,,\n (\\#eq:null-multinomial)\n\\end{equation}\nthat completely specifies a value $p_{i0}$ for each $p_i$.^[Here for $i=1, \\dots, k$ we use the notation $p_{i0}$ to denote the value of $p_i$ claimed under the null hypothesis.] The alternative hypothesis $H_a$ will state that $H_0$ is not true, i.e., that at least one $p_i$ is different from the value $p_{i0}$ claimed under the null $H_0$. \n\nProvided the null hypothesis in \\@ref(eq:null-multinomial) is true, the expected values \\@ref(eq:mean-count-multinomial) can be written in terms of the expected frequencies,\n\\begin{equation*}\n \\E[N_i] = m p_{i0}\\,, \\quad i=1,\\dots,k\\,.\n\\end{equation*}\nOften the $n_i$, referred to as the **observed cell counts**, and the corresponding $m p_{i0}$, referred to as the **expected cell counts**, are tabulated, for example, as in Table \\@ref(tab:cell-counts).   \n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\\begin{table}[!h]\n\\centering\n\\caption{\\label{tab:cell-counts}Observed and expected cell counts.}\n\\centering\n\\begin{tabular}[t]{cccccc}\n\\toprule\nCategory & $i=1$ & $i=2$ & $\\cdots$ & $i=k$ & Row total\\\\\n\\midrule\n\\cellcolor{gray!10}{Observed} & \\cellcolor{gray!10}{$n_1$} & \\cellcolor{gray!10}{$n_2$} & \\cellcolor{gray!10}{$\\cdots$} & \\cellcolor{gray!10}{$n_k$} & \\cellcolor{gray!10}{$m$}\\\\\nExpected & $mp_{10}$ & $mp_{20}$ & $\\cdots$ & $mp_{k0}$ & $m$\\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n\n\n:::\n:::\n\n\n\nThe test procedure assesses the discrepancy between the value of the observed and expected cell counts. This discrepancy, or **goodness of fit**, is measured by the squared deviations divided by the expected count.^[The division by the expected cell counts accounts for possible differences in the relative magnitude of the observed/expected counts.]\n\n\n\n::: {.cell}\n\n```{.theorem .cell-code}\nFor $m p_i \\geq 5$ for $i = 1, \\dots, k$, the rv\n\\begin{equation*}\n V = \\sum_{i=1}^k \\frac{(N_i - m p_i)^2}{m p_i} \\quad \\sim \\chi^2(k-1)\\,,\n\\end{equation*}\nthat is, $V$ has approximately a $\\chi^2$ distribution with $\\nu = k-1$ df. \n```\n:::\n\n::: {.cell}\n\n```{.proposition .cell-code}\nConsider the null\n\\begin{equation*}\nH_0 : p_1 = p_{10}, p_2 = p_{20}, \\cdots, p_k = p_{k0}\\,,\n\\end{equation*}\nand the alternative \n\\begin{equation*}\nH_a : p_i \\neq p_{i0}\\; \\text{for at least one}\\; i\\,.\n\\end{equation*}\nThe test statistic is\n\\begin{equation*}\n V = \\sum_{i=1}^k \\frac{(N_i - m p_{i0})^2}{m p_{i0}}\\,.\n\\end{equation*}\nAs a rule of thumb, provided $m p_{i0} \\geq 5$ for all $i = 1, \\dots, k$, then the $P$-value is the area under $\\chi^2(k-1)$ to the right of $v$. \n```\n:::\n\n\n\nIf $m p_{i0} < 5$ for some $i$ then it may be possible to combine the categories such that the new categorizations satisfy the assumptions of Proposition \\@ref(prp:htest-multinomial).\n\n:::{.warningblock data-latex=\"\"}\nThings are much more complicated if the category probabilities are not entirely specified.   \n:::   \n\n<!-- ## Test for normality -->\n\n<!-- Probability plots comparing the theoretical quantiles of the normal distribution against the quantiles of sample data were introduced as an informal way of determining whether a distribution was normal (cf. Figures \\@ref(fig:qq-plot-cherry) and \\@ref(fig:qc-beer-pH-norm)); the closer the fit to a straight line, the more substantial the evidence that the distribution is normal. In Section \\@ref(correlation), we saw how the sample correlation $r$ was a quantitative measure of linear association. We give a special test for normality called the **Ryan--Joiner test**.  -->\n\n<!-- ```{theorem, ryan-joiner-test} -->\n<!-- For ordered^[Ordered smallest to largest.] sample data $x_{(1)}, x_{(2)}, \\dots, x_{(m)}$, let  -->\n<!-- \\begin{equation*} -->\n<!--  y_i = \\Phi^{-1}\\left( \\frac{i - 0.375}{m + 0.25}\\right)\\,. -->\n<!-- \\end{equation*} -->\n<!-- Compute the sample correlation coefficient $r$ in \\@ref(eq:sample-correlation-statistic) for the pairs $(x_{(1)}, y_1), \\dots, (x_{(m)}, y_m)$. For a level, $\\alpha$, the **Ryan--Joiner test** assumes the null hypothesis -->\n<!-- \\begin{equation*} -->\n<!--  H_0 : \\text{the population distribution is normal}\\,, -->\n<!-- \\end{equation*} -->\n<!-- against the alternative  -->\n<!-- \\begin{equation*} -->\n<!--  H_a : \\text{the population distribution is not normal}\\,. -->\n<!-- \\end{equation*} -->\n<!-- using the test statistic \\@ref(eq:sample-correlation-statistic). The $P$-value is the area under the  -->\n<!-- ``` -->\n\n## Test for the independence of factors\n\nIn Section \\@ref(goodness-of-fit-tests), we considered categorising a population into a single factor. We now consider a single population where each individual is categorised into two factors with $I$ distinct categories for the first factor and $J$ distinct categories for the second factor. Each individual from the population belongs to exactly one of the $I$ categories of the first factor and exactly one of the $J$ categories of the second factor. We want to determine whether or not there is any dependency between the two factors. \n\nFor a sample of $m$ individuals, we denote by $n_{ij}$ the count of the $m$ samples that fall both in category $i$ of the first factor and category $j$ of the second factor, for $i = 1, \\dots, I$ and $j = 1, \\dots, J$. A **contingency (data) table** with $I$ rows and $J$ columns (i.e., $IJ$ cells) will be used to record the $n_{ij}$ counts (in an obvious way).^[Contingency is another word for dependency in this context.] Let $p_{ij}$ be the proportion of individuals in the population who belong in category $i$ of factor 1 and category $j$ of factor $2$. Then, the probability that a randomly selected individual falls in category $i$ of factor 1 is found by summing over all $j$:\n\\begin{equation*}\np_{i} = \\sum_{j=1}^J p_{ij}\\,,\n\\end{equation*}\nand likewise, the probability that a randomly selected individual falls in category $j$ of factor 2 is found by summing over all $i$:\n\\begin{equation*}\np_{j} = \\sum_{i=1}^I p_{ij}\\,.\n\\end{equation*}\nThe null hypothesis that we will be interested in adopting is\n\\begin{equation*}\nH_0 : p_{ij} = p_{i} \\cdot p_{j} \\; \\forall (i,j)\\,,\n (\\#eq:null-two-factor)\n\\end{equation*}\nthat is, an individual's category in factor 1 is independent of the category in factor 2. \n\nFollowing the same program as for the single category goodness-of-fit test, we note that assuming the null hypothesis \\@ref(eq:null-two-factor) is true, then the expected count in cell $i,j$ is\n\\begin{equation*}\n \\E[N_{ij}] = m p_{ij} = m p_{i} p_{j}\\,;\n\\end{equation*}\nand we estimate $p_i$ and $p_j$ by the appropriate sample proportion:\n\\begin{equation*}\n\\widehat{p}_i = \\frac{n_i}{m}\\,, \\qquad n_i = \\sum_{j} n_{ij} \\quad \\text{(row totals)}\\,,\n\\end{equation*}\nand \n\\begin{equation*}\n\\widehat{p}_j = \\frac{n_j}{m}\\,, \\qquad n_j = \\sum_{i} n_{ij}\\quad \\text{(column totals)}\\,.\n\\end{equation*}\nThus, the expected cell count is given by\n\\begin{equation*}\n\\widehat{e}_{ij} = m \\widehat{p}_i \\widehat{p}_j = \\frac{n_i n_j}{m}\\,,\n\\end{equation*}\nand we assess the goodness of fit between the observed cell count $n_ij$ and the expected cell count $\\widehat{e}_ij$.\n\n\n\n\n::: {.cell}\n\n```{.proposition .cell-code}\nAssume the null hypothesis \n\\begin{equation*}\nH_0 : p_{ij} = p_i p_j \\; \\text{for all } i=1, \\dots, I\\,, j=1, \\dots, J\\,,\n\\end{equation*}\nagainst the alternative hypothesis \n\\begin{equation*}\nH_a : H_0 \\;\\text{is not true}\\,. \n\\end{equation*}\nThe test statistic is \n\\begin{equation*}\nV = \\sum_{i=1}^I \\sum_{j=1}^J \\frac{(N_{ij} - \\widehat{e}_{ij})^2}{\\widehat{e}_{ij}} \\,.\n\\end{equation*}\nAs a rule of thumb, provided $\\widehat{e}_{ij} \\geq 5$ for all $i,j$ and when $H_0$ is true, then the test statistic has approximately a $\\chi^2(\\nu)$ distribution with $\\nu = (I-1)(J-1)$ df. For a hypothesis test at level $\\alpha$, the procedure is upper-tailed, and the $P$-value is the area under $\\chi^2(\\nu)$ to the right of $v$. \n```\n:::\n",
    "supporting": [
      "07-categorical-data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}